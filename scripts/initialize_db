#!/usr/bin/env python


import sys
from pymongo import MongoClient

from relentlessdrv.datastructures import DATABASE_FORMAT



REQUIRED_FIELDS = list(DATABASE_FORMAT)


# SECOND ARGUMENT is always dburl if given
nargs = 2
nargv = len(sys.argv[1:])

args = list()

assert 1 == nargv <= nargs


# SECOND ARGUMENT is always dburl if given
if nargv:
    args = sys.argv[1:]
    dbname = sys.argv[1]


if nargv > 1:
    dburl = args[2]
else:
    dburl = "mongodb://127.0.0.1/mongodb/"



client = MongoClient(dburl)

newdb = client[dbname]


for field in REQUIRED_FIELDS:
    newdb.create_collection(field)



